(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{155:function(e,t,a){},156:function(e,t,a){},157:function(e,t,a){},158:function(e,t,a){},159:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),s=a(45),r=a.n(s),l=a(4),i=a(11),o=a(3),u=Object(n.createContext)({theme:localStorage.getItem("theme")||"theme-auto",setTheme:function(){}}),j=a(5),b=a.n(j),m=a(6),d=a(0);var h=function(e){var t=e.linkName,a=e.link;return Object(d.jsx)("li",{className:"nav__item",children:Object(d.jsx)(i.b,{className:"nav__link",to:a,children:t})})},p=a(10),O=a.n(p),g=c.a.createContext({}),v=function(e){var t=e.children,a=Object(n.useState)(null),c=Object(l.a)(a,2),s=c[0],r=c[1],i=Object(n.useState)(!1),o=Object(l.a)(i,2),u=o[0],j=o[1],h=Object(n.useState)(localStorage.getItem("refresh")),p=Object(l.a)(h,2),v=p[0],f=p[1],x=Object(n.useState)(localStorage.getItem("access")),N=Object(l.a)(x,2),S=N[0],w=N[1],A=Object(n.useCallback)(function(){var e=Object(m.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/auth/token",{token:t});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);Object(n.useEffect)((function(){Object(m.a)(b.a.mark((function e(){var t,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v||"undefined"===v||u){e.next=16;break}return e.prev=1,e.next=4,A(v);case 4:t=e.sent,a=t.data,w(a.accessToken),localStorage.setItem("access",a.accessToken),r(a.email),j(!0),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.log(e.t0),f(null);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})))()}),[v,A,u]);var k=Object(n.useCallback)(function(){var e=Object(m.a)(b.a.mark((function e(t){var a,n,c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.email,n=t.password,e.prev=1,e.next=4,O.a.post("/api/auth/login",{email:a,password:n});case 4:c=e.sent,s=c.data,f(s.refreshToken),w(s.accessToken),localStorage.setItem("refresh",s.refreshToken),localStorage.setItem("access",s.accessToken),r(a),j(!0),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),e.t0.isAxiosError?console.log(e.t0.response.data.error):console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),[]),I=Object(n.useCallback)(function(){var e=Object(m.a)(b.a.mark((function e(t){var a,n,c,s,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.firstName,n=t.lastName,c=t.email,s=t.password,e.prev=1,e.next=4,O.a.post("/api/auth/sign-up",{firstName:a,lastName:n,email:c,password:s});case 4:return r=e.sent,e.abrupt("return",r.data);case 8:if(e.prev=8,e.t0=e.catch(1),!e.t0.isAxiosError){e.next=14;break}throw e.t0.response.data.error;case 14:throw console.log(e.t0),Error("Something went bad");case 16:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),[]),E=Object(n.useCallback)(Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/auth/logout",{},{headers:{Auth:S}});case 2:r(null),j(!1),localStorage.removeItem("refresh"),localStorage.removeItem("access");case 6:case"end":return e.stop()}}),e)}))),[S]);return Object(d.jsx)(g.Provider,{value:{loggedIn:u,email:s,accessToken:S,login:k,logout:E,signUp:I},children:t})};var f=function(){var e=Object(n.useContext)(g),t=e.loggedIn,a=e.logout,c=Object(o.f)();return Object(d.jsxs)("ul",{className:"nav__list",children:[Object(d.jsx)(h,{linkName:"Home",link:"/"}),t?[Object(d.jsx)(h,{linkName:"Chat Room",link:"/chat"},"chat"),Object(d.jsx)("button",{className:"default--button",onClick:Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:c("/");case 3:case"end":return e.stop()}}),e)}))),style:{backgroundColor:"red",padding:".1em .5em"},children:"Logout"},"logout")]:[Object(d.jsx)(h,{linkName:"Login",link:"/login"},"login"),Object(d.jsx)(h,{linkName:"Sign Up",link:"/sign-up"},"sign-up")]]})};var x=function(){return Object(d.jsx)("nav",{className:"nav",children:Object(d.jsx)(f,{})})};var N=function(){return Object(d.jsx)(i.b,{to:"/",className:"logo",children:Object(d.jsx)("img",{className:"logo-img",src:"../favicon.ico",alt:"Logo"})})};var S=function(){var e=Object(n.useContext)(u).setTheme,t=Object(n.useState)(localStorage.getItem("theme")||"theme-auto"),a=Object(l.a)(t,2),c=a[0],s=a[1];return Object(d.jsxs)("select",{value:c?c.split("-")[1]:"auto",className:"select-theme",id:"select-theme",onChange:function(t){localStorage.setItem("theme","theme-".concat(t.target.value)),s(t.target.value),e("theme-".concat(t.target.value))},children:[Object(d.jsx)("option",{value:"auto",children:"Auto"}),Object(d.jsx)("option",{value:"light",children:"Light"}),Object(d.jsx)("option",{value:"dark",children:"Dark"})]})};var w=function(){return Object(d.jsxs)("div",{className:"theme",children:[Object(d.jsx)("label",{id:"theme-icon",className:"theme-icon"}),Object(d.jsx)(S,{})]})};a(71);var A=function(){return Object(d.jsx)("header",{children:Object(d.jsxs)("div",{className:"header-container",children:[Object(d.jsxs)("div",{className:"logo-and-theme",children:[Object(d.jsx)(N,{}),Object(d.jsx)(w,{})]}),Object(d.jsx)(x,{})]})})};var k=function(){return Object(d.jsx)("div",{})},I=a(46);a(72);var E=function(e){var t=e.online;return Object(d.jsx)("aside",{className:"chat__aside",children:t.map((function(e,t){return Object(d.jsxs)("div",{className:"aside__user",children:[Object(d.jsx)("div",{className:"online-circle"}),Object(d.jsx)("div",{className:"aside__user--email",children:e},t)]})}))})};var B=function(e){var t=["#e69f73","#db5ec2","#35cd96","#91ab01","#6bcbef","#dfb610","#00b33e","#fd85d4","#e67072","#ba33dc","#c69478","#bd88eb","#8b7add","#fe7c7f","#3bdec3","#e68200"],a=0;if(0===e.length)return a;for(var n=0;n<e.length;n++)a=e.charCodeAt(n)+((a<<5)-a),a&=a;return t[a=(a%t.length+t.length)%t.length]},y=function(e){var t=e.dir,a=e.user,n=e.content,c=e.timestamp;return Object(d.jsx)("div",{className:"message__container message__container--".concat(t),children:Object(d.jsxs)("div",{className:"chat__message message--".concat(t),children:[Object(d.jsx)("div",{className:"message__user",style:{color:B(a)},children:a}),Object(d.jsx)("div",{className:"message__content",children:n}),Object(d.jsx)("div",{className:"message__timestamp",children:c})]})})};var T=function(){var e=Object(n.useContext)(g).accessToken,t=Object(n.useState)(""),a=Object(l.a)(t,2),c=a[0],s=a[1],r=function(){var t=Object(m.a)(b.a.mark((function t(a){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.next=3,O.a.post("/api/chat/message",{content:c},{headers:{auth:e}});case 3:s("");case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(d.jsx)("div",{className:"send-message",children:Object(d.jsxs)("form",{className:"send-message__form",onSubmit:r,children:[Object(d.jsx)("input",{type:"text",placeholder:"Type a message",value:c,onChange:function(e){return s(e.target.value)},className:"send-message__input"}),Object(d.jsx)("button",{className:"send-message__button",children:"Send"})]})})};var M=a(23);var R=function(e){var t=e.messages,a=Object(n.useContext)(g).email;return Object(d.jsxs)("div",{className:"chat__box--container",children:[Object(d.jsx)("div",{className:"chat__box",children:Object(d.jsx)("div",{className:"chat__box--messages",children:t&&t.map((function(e,t){return Object(d.jsx)(y,{dir:a===e.email?"right":"left",user:e.email,content:e.content,timestamp:new Date(Number(e.timestamp)).toLocaleString()},t)}))})}),Object(d.jsx)(T,{})]})};var Z=function(){var e=Object(n.useContext)(g),t=e.accessToken,a=e.loggedIn,c=Object(n.useState)([]),s=Object(l.a)(c,2),r=s[0],i=s[1],u=Object(n.useState)([]),j=Object(l.a)(u,2),h=j[0],p=j[1],O=Object(o.f)();return Object(n.useEffect)((function(){a||O("/");var e=new M.EventSourcePolyfill("http://localhost:8080/api/chat/message",{headers:{"Content-Type":"text/event-stream",auth:t}});e.onopen=Object(m.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("connection to stream has been opened");case 1:case"end":return e.stop()}}),e)}))),e.onerror=function(e){console.log("An error has occurred while receiving stream",e)},e.onmessage=function(e){var t=JSON.parse(e.data);t.messages&&i(t.messages),t.newMessage&&i((function(e){return[].concat(Object(I.a)(e),[t.newMessage])})),t.online&&p(t.online)}}),[]),Object(d.jsx)("div",{className:"chat",children:Object(d.jsxs)("div",{className:"chat-container",children:[Object(d.jsx)(E,{online:h}),Object(d.jsx)(R,{messages:r})]})})};var D=function(e){var t=e.id,a=e.value;return Object(d.jsx)("span",{className:"invalid-message",id:t,children:a||""})};var J=function(e){var t=e.labelValue,a=e.type,c=e.id,s=e.placeholder,r=e.state,i=e.setState,o=e.onBlur,u=Object(n.useState)(),j=Object(l.a)(u,2),b=j[0],m=j[1];return Object(d.jsxs)("div",{className:"form-element",children:[Object(d.jsx)("label",{htmlFor:c,children:t}),Object(d.jsx)("input",{id:c,type:a,placeholder:s,value:r,onChange:function(e){return i(e.target.value)},onBlur:function(e){return o(e,m)}}),Object(d.jsx)(D,{id:"".concat(c,"-invalid-message"),value:b})]})};a(73);var C=function(e){var t=e.containerClass,a=e.id,n=e.title,c=e.formElements,s=e.submitValue,r=e.handleSubmit;return Object(d.jsx)("div",{className:t,children:Object(d.jsxs)("form",{id:a,className:"form",onSubmit:r,children:[Object(d.jsx)("h2",{children:n}),c.map((function(e,t){var a=e.labelValue,n=e.type,c=e.id,s=e.placeholder,r=e.state,l=e.setState,i=e.handleBlur;return Object(d.jsx)(J,{labelValue:a,type:n,id:c,placeholder:s,state:r,setState:l,onBlur:i},"".concat(t))})),Object(d.jsx)("div",{className:"form-element",children:Object(d.jsx)("button",{className:"default--button",children:s})})]})})},U=(a(74),a(12)),L=a.n(U);var P=function(){var e=Object(n.useContext)(g),t=e.login,a=e.loggedIn,c=Object(n.useState)(""),s=Object(l.a)(c,2),r=s[0],i=s[1],u=Object(n.useState)(""),j=Object(l.a)(u,2),h=j[0],p=j[1],O=Object(o.f)();Object(n.useEffect)((function(){a&&O("/")}),[a,O]);var v=[{labelValue:"Email",type:"email",id:"email",placeholder:"Enter Email",state:r,setState:i,handleBlur:function(e,t){L.a.isEmail(e.target.value)?t(""):t("Invalid email")}},{labelValue:"Password",type:"password",id:"password",placeholder:"Enter Password",state:h,setState:p,handleBlur:function(e,t){L.a.isStrongPassword(e.target.value,{minSymbols:0})?t(""):t("Password must contain at least one uppercase, one lowercase and one number")}}],f=function(){var e=Object(m.a)(b.a.mark((function e(a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,t({email:r,password:h});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)(C,{containerClass:"log-in-container",id:"log-in-form",title:"Log In",formElements:v,submitValue:"Log In",handleSubmit:f})};var W=function(e){var t=e.ghName,a=e.ghLink;return Object(d.jsxs)("a",{className:"copyright-link",href:a,target:"_blank",rel:"noopener noreferrer",children:[Object(d.jsx)("span",{children:t}),Object(d.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==",className:"github-img",alt:""})]})};a(155);var Y=function(){return Object(d.jsx)("footer",{children:Object(d.jsx)("div",{className:"footer-container",children:Object(d.jsxs)("p",{className:"copyright",children:[Object(d.jsx)("span",{children:"\xa9 Copyright 2021"}),Object(d.jsx)(W,{ghLink:"https://github.com/shaharkamay",ghName:"Shahar Kamay"})]})})})};a(156);var G=function(){var e=Object(n.useContext)(g),t=e.email,a=e.loggedIn;return Object(d.jsx)("div",{className:"hello",children:Object(d.jsxs)("div",{className:"hello-container",children:["Hello,",a?" ".concat(t):" guest"]})})};a(157);var V=function(){var e=Object(n.useContext)(g),t=e.signUp,a=e.loggedIn,c=Object(o.f)(),s=Object(n.useState)(""),r=Object(l.a)(s,2),i=r[0],u=r[1],j=Object(n.useState)(""),h=Object(l.a)(j,2),p=h[0],O=h[1],v=Object(n.useState)(""),f=Object(l.a)(v,2),x=f[0],N=f[1],S=Object(n.useState)(""),w=Object(l.a)(S,2),A=w[0],k=w[1];Object(n.useEffect)((function(){a&&c("/")}),[a,c]);var I=[{labelValue:"First Name",type:"text",id:"first-name",placeholder:"Enter first name",state:i,setState:u,handleBlur:function(e,t){L.a.isAlpha(e.target.value)?t(""):t("Invalid name")}},{labelValue:"Last Name",type:"text",id:"last-name",placeholder:"Enter last name",state:p,setState:O,handleBlur:function(e,t){L.a.isAlpha(e.target.value)?t(""):t("Invalid name")}},{labelValue:"Email",type:"email",id:"email",placeholder:"Enter Email",state:x,setState:N,handleBlur:function(e,t){L.a.isEmail(e.target.value)?t(""):t("Invalid email")}},{labelValue:"Password",type:"password",id:"password",placeholder:"Enter Password",state:A,setState:k,handleBlur:function(e,t){L.a.isStrongPassword(e.target.value,{minSymbols:0})?t(""):t("Password must contain at least one uppercase, one lowercase and one number")}}],E=function(){var e=Object(m.a)(b.a.mark((function e(a){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,t({firstName:i,lastName:p,email:x,password:A});case 3:e.sent.isSignedUp&&c("/login");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(d.jsx)(C,{containerClass:"sign-up-container",id:"sign-up-form",title:"Sign Up",formElements:I,submitValue:"Sign Up",handleSubmit:E})};var _=function(){var e=Object(n.useState)(localStorage.getItem("theme")||"theme-auto"),t=Object(l.a)(e,2),a=t[0],c={theme:a,setTheme:t[1]};return Object(d.jsx)(v,{children:Object(d.jsx)(u.Provider,{value:c,children:Object(d.jsx)("div",{className:"App ".concat(a),children:Object(d.jsxs)(i.a,{children:[Object(d.jsx)(A,{}),Object(d.jsx)(G,{}),Object(d.jsx)("main",{children:Object(d.jsxs)(o.c,{children:[Object(d.jsx)(o.a,{exact:!0,path:"/",element:Object(d.jsx)(k,{})}),Object(d.jsx)(o.a,{path:"/chat",element:Object(d.jsx)(Z,{})}),Object(d.jsx)(o.a,{path:"/login",element:Object(d.jsx)(P,{})}),Object(d.jsx)(o.a,{path:"/sign-up",element:Object(d.jsx)(V,{})})]})}),Object(d.jsx)(Y,{})]})})})})};a(158);r.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(_,{})}),document.getElementById("root"))},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){}},[[159,1,2]]]);
//# sourceMappingURL=main.3b6f4185.chunk.js.map